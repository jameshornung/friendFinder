<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Survey</title>

<!-- Latest compiled and minified CSS & JS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

</head>
<body>
	<div class="container">
	
		<h1>Take the Survey</h1>
		<hr>
		<form role="form">
			<h2>About you</h2>
			<div class="form-group">
				<label for="usr">Name:</label>
				<input type="text" class="form-control" id="name">
			</div>
			<div class="form-group">
				<label for="pic">URL for Photo:</label>
				<input type="text" class="form-control" id="pic">
			</div>
			<hr>
			<h2>Rate how strongly you agree with the following statements:</h2>
			<h4>1 = Do Not Agree at All</h4>
			<h4>5 = Strongly Agree</h4>
			<hr>
			<h3>Question 1</h3>
			<h4>I have entered, and won, a professional eating contest.</h4>
			<div class="form-group">
				<!-- <label for="sel1">Select list:</label> -->
				<select class="form-control" id="quest1">
					<option>1 (Absolutely Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
			<h3>Question 2</h3>
			<h4>I would rather attend a Pearl Jam concert than a Taylor Swift show.</h4>
			<div class="form-group">
				<!-- <label for="sel1">Select list:</label> -->
				<select class="form-control" id="quest2">
					<option>1 (Absolutely Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
			<h3>Question 3</h3>
			<h4>I like my steak well done, not a trace of pink.</h4>
			<div class="form-group">
				<!-- <label for="sel1">Select list:</label> -->
				<select class="form-control" id="quest3">
					<option>1 (Absolutely Disagree)</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5 (Strongly Agree)</option>
				</select>
			</div>
			
			<button type="button" class="btn btn-success btn-block" id="submit">Submit</button>
	
		</form>

		<!-- Modal -->
  <div class="modal fade" id="friend-modal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title"></h4>
        </div>
        <div class="modal-body">
          <p>this is the correct modal.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>

	</div>
<script type="text/javascript">
		 
	$('#submit').on("click", function(){
		// console.log(parseInt($('#quest1').val().substring(0,1)));

		var answerArray = [];

		for(i=1; i<4; i++){
			answerArray.push(parseInt($('#quest' + i).val().substring(0,1)));
		}
		var newFriend = 
		{
			name: $("#name").val().trim(),
			photo: $("#pic").val().trim(),
			scores: answerArray
		};

		var currentURL = window.location.origin;

		// =======
		$.post(currentURL + "/api/friends", newFriend,
	    function(data){});

		$.ajax({url: currentURL + "/api/friends", method: "GET"}) 
			.done(function(res){
				
				var differenceArray = [];
				// console.log(newFriend.scores[0]);
				// console.log(res[0].scores[0]);

				for(i=0; i<res.length - 1; i++){
					for(j=0; j<3; j++){
						var currentDifference = newFriend.scores[j] - res[i].scores[j];
						differenceArray.push(Math.abs(currentDifference));
					}
					console.log(res[i].name)
				}
				console.log(differenceArray);
				friendName = res[2].name;
				friendPic = res[2].photo;
				
				var friendName = '<h4>' + friendName + '<h4>';
				var friendPic = '<img src=' + friendPic + '>';

				$('#friend-modal').modal('show');
				$('#friend-modal h4').html(friendName);
				$('.modal-body').html(friendPic);
			});


		
return false;

});

</script>
</body>